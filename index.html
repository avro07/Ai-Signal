<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Live Coin Signal</title>
    <link rel="manifest" href="./manifest.json" />
    <meta name="theme-color" content="#06b6d4" />

    <!-- iOS PWA Enhancements for fullscreen experience -->
    <link rel="apple-touch-icon" href="./icon-192.png" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Live Coin Signal" />

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <!-- SystemJS and Babel for in-browser transpilation -->
    <script src="https://cdn.jsdelivr.net/npm/systemjs@6.14.3/dist/system.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="systemjs-importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0?target=system",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?target=system",
        "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime?target=system",
        "@google/genai": "https://esm.sh/@google/genai@0.1.1?target=system"
      }
    }
    </script>
    
    <script>
      (function() {
        // Configure SystemJS to use Babel for TS/TSX files
        const originalFetch = System.constructor.prototype.fetch;
        System.constructor.prototype.fetch = function(url) {
            return originalFetch.apply(this, arguments).then(function(source) {
                if (url.endsWith('.tsx') || url.endsWith('.ts')) {
                    // Transpile to System.register format
                    try {
                        return Babel.transform(source, {
                            filename: url,
                            presets: [
                                ['react', { runtime: 'automatic' }],
                                'typescript'
                            ],
                            plugins: ['transform-modules-systemjs'] 
                        }).code;
                    } catch (e) {
                        console.error('Babel compilation error for ' + url, e);
                        return source;
                    }
                }
                return source;
            });
        };

        // Custom resolver to handle missing extensions in imports
        const originalResolve = System.constructor.prototype.resolve;
        System.constructor.prototype.resolve = function(id, parentUrl) {
            let resolved = originalResolve.call(this, id, parentUrl);
            
            // If it's a relative import and likely missing an extension
            if ((id.startsWith('./') || id.startsWith('../')) && !id.endsWith('.js') && !id.endsWith('.css')) {
                // If the resolved URL doesn't already have the correct extension
                if (!resolved.endsWith('.ts') && !resolved.endsWith('.tsx')) {
                    // Heuristic: Hooks, Services, Types, Constants are usually .ts
                    if (id.includes('hooks/') || id.includes('services/') || id.includes('types') || id.includes('constants/')) {
                        return resolved + '.ts';
                    }
                    // Components and App are usually .tsx
                    return resolved + '.tsx';
                }
            }
            return resolved;
        };
      })();
    </script>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/",
    "react": "https://aistudiocdn.com/react@^19.2.0"
  }
}
</script>
</head>
  <body class="bg-gray-900 text-gray-100">
    <div id="root"></div>
    <script>
        System.import('./index.tsx').catch(console.error);
    </script>
  </body>
</html>